{"version":3,"sources":["../../../src/setup/server/database.js"],"names":["console","info","connectWithRetry","mongoose","connection","on","error","log","message","setTimeout","connect","MONGO_URL","useNewUrlParser","useCreateIndex","useFindAndModify","useUnifiedTopology"],"mappings":";;;;;;;;;;;;;AACA;;AAGA;;AAJA;AAGA;AAGA;;;EAOA;;;;uFANe;AAAA;AAAA;AAAA;AAAA;AACbA,YAAAA,OAAO,CAACC,IAAR,CAAa,+BAAb;AADa;AAAA,mBAGPC,gBAAgB,EAHT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAOfC,qBAASC,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAgC,UAAAC,KAAK,EAAI;AACvCN,EAAAA,OAAO,CAACO,GAAR,sCAA2CD,KAAK,CAACE,OAAjD;AAEAC,EAAAA,UAAU,6FAAC;AAAA;AAAA;AAAA;AAAA;AACTT,YAAAA,OAAO,CAACO,GAAR,CAAY,0CAAZ;AADS;AAAA,mBAGHL,gBAAgB,EAHb;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,IAIP,IAJO,CAAV;AAKD,CARD,E,CAUA;;;AACA,IAAMA,gBAAgB;AAAA,4FAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACVC,qBAASO,OAAT,CAAiBC,cAAjB,EAA4B;AAAEC,cAAAA,eAAe,EAAE,IAAnB;AAAyBC,cAAAA,cAAc,EAAE,IAAzC;AAA+CC,cAAAA,gBAAgB,EAAE,KAAjE;AAAwEC,cAAAA,kBAAkB,EAAE;AAA5F,aAA5B,CADU;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAhBb,gBAAgB;AAAA;AAAA;AAAA,GAAtB","sourcesContent":["// Imports\r\nimport mongoose from 'mongoose'\r\n\r\n// App Imports\r\nimport { MONGO_URL } from '../config/env'\r\n\r\n// Connect database\r\nexport default async function () {\r\n  console.info('SETUP - Connecting database..')\r\n\r\n  await connectWithRetry()\r\n}\r\n\r\n// Handle connection error\r\nmongoose.connection.on('error', error => {\r\n  console.log(`ERROR - Connection failed: ${ error.message }`)\r\n\r\n  setTimeout(async () => {\r\n    console.log('SETUP - Connecting database.. retrying..')\r\n\r\n    await connectWithRetry()\r\n  }, 5000)\r\n})\r\n\r\n// Retry connection\r\nconst connectWithRetry = async () => {\r\n  return await mongoose.connect(MONGO_URL, { useNewUrlParser: true, useCreateIndex: true, useFindAndModify: false, useUnifiedTopology: true })\r\n}\r\n"],"file":"database.js"}